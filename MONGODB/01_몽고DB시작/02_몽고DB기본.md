# 02. 몽고DB 기본

* 몽고DB 데이터의 기본 단위는 **도큐먼트**이며, 이는 관계형 데이터베이스의 행과 유사하다.
* **컬렉션**은 동적 스키마가 없는 테이블과 같다.
* 몽고DB의 단일 인스턴스는 자체적인 컬렉션을 갖는 여러 개의 독립적인 데이터베이스를 호스팅한다.
* 모든 도큐먼트는 컬렉션 내에서 고유한 특수키인 "_id"를 가진다.
* 몽고DB는 **몽고 쉘**이라는 간단하지만 강력한 도구와 함께 배포된다. 몽고 쉘은 몽고DB 인스턴스를 관리하고 몽고 DB 쿼리 언어로 데이터를 조작하기 위한 내장 지원을 제공한다.
    또한 사용자가 다양한 목적으로 자신의 스크립트를 만들고 로드할 수 있는 완전한 기능의 자바스크립트 interpreter이다.



## 2.1 도큐먼트

몽고DB의 핵심은 정렬된 키와 연결된 값의 집합으로 이뤄진 **도큐먼트**다. 도큐먼트 표현 방식은 프로그래밍 언어마다 다르지만 대부분의 언어는 map, hash, dictionary와 같이 도큐먼트를 자연스럽게 표현하는 자료구조를 가진다.

도큐먼트의 키는 문자열이다. 예외 몇 가지를 제외하면 어떤 UTF-8 문자든 쓸 수 있다.

* 키는 \0(null)을 포함하지 않는다. null은 키의 끝을 나타내는 데 사용된다.
* .과 $ 문자는 몇 가지 특별한 속성을 가진 예약어이다.



몽고DB는 데이터형과 대소문자를 구별하기 때문에 아래 두 도큐먼트는 서로 다릅니다.

``` 
{"count": 5}
{"count": "5"}
```

```
{"count": 5}
{"Count": 5}
```



또한 도큐먼트는 키가 중복될 수 없다.



## 2.2 컬렉션

**컬렉션**은 도큐먼트의 모음이다. 위에서 말했듯이 테이블에 대응되는 개념이다.



### 2.2.1 동적 스키마

컬렉션은 **동적 스키마**를 가진다. 동적 스키마를 가진다는 말은 하나의 컬렉션 내 도큐먼트들이 모두 다른 구조를 가질 수 있다는 의미다. 예를 들어 다음 도큐먼트들은 하나의 컬렉션에 저장할 수 있다.

``` 
{"A": "hello", "B": 3}
{"C": "mongoDB"}
```



도큐먼트들의 키, 키의 개수, 데이터형의 값은 모두 다르다. 다른 구조의 도큐먼트라도 같은 컬렉션에 저장할 수 있는데 '왜 별도의 컬렉션이 필요하지?'라고 생각할 수 있다. 도큐먼트에 별도의 스키마가 필요 없는데 왜 하나 이상의 컬렉션이 필요할까?

* 같은 컬렉션에 다른 종류의 도큐먼트를 저장하면 개발자와 관리자에게 번거로운 일이 생길 수도 있다. 각 쿼리가 특정 스키마를 고수하는 도큐먼트를 반환하는지, 혹은 쿼리한 코드가 다른 구조의 도큐먼트를 다룰 수 있는지 확실히 확인하자. 예를 들어 블로그 게시물을 쿼리한 데이터 중 작성자 데이터만 제거하려면 상당히 번거롭다.
* 컬렉션별로 목록을 뽑으면 한 컬렉션 내 특정 데이터형별로 쿼리해서 목록을 뽑을 때마다 훨씬 빠르다. 예를 들어 "요약", "전체", "뚱뚱이 원숭이"와 같은 컬렉션형을 값으로 하는 "type"키가 도큐먼트 내에 있다면, 단일 컬렉션에 들어 있는 값을 찾기보다 세 컬렉션 중에서 올바른 컬렉션을 쿼리하는 편이 훨씬 빠르다.
* 같은 종류의 데이터를 하나의 컬렉션에 모아두면 데이터 지역성에도 좋다. 블로그 게시물 여러 개를 뽑는 경우, 게시물과 저자 정보가 섞인 컬렉션보다 게시물만 들어 있는 컬렉션에서 뽑을 때 디스크 탐색 시간이 더 짧다.
* 인덱스를 만들면 도큐먼트는 특정 구조를 가져야 한다. 이러한 인덱스는 컬렉션별로 정의한다.



애플리케이션 스키마는 기본적으로 필요하지는 않지만 정의하면 좋다. 몽고DB의 도큐먼트 유효성 검사 기능과 객체-도큐먼트 매핑 라이브러리를 이용하며, 이는 많은 프로그래밍 언어에서 사용 가능하다.



### 2.2.2 네이밍

